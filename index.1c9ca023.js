const t=document.querySelector(".start"),e=document.querySelector(".game-score"),s=[...document.querySelector(".game-field").tBodies[0].children],i=document.querySelector(".message-start"),a=document.querySelector(".message-win"),n=document.querySelector(".message-lose"),h=new class{constructor(t){this.initialState=t||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.state=JSON.parse(JSON.stringify(this.initialState)),this.status="idle"}moveLeft(){let t=JSON.stringify(this.initialState);for(let t=0;t<this.state.length;t+=1){let e=this.state[t].filter(t=>0!==t),s=[],i=!1;for(let t=0;t<e.length;t+=1){if(i){i=!1;continue}e[t]===e[t+1]?(this.score+=2*e[t],s.push(2*e[t]),i=!0):s.push(e[t])}for(;s.length<4;)s.push(0);this.state[t]=s}JSON.stringify(this.state)!==t&&(this.addRandomToState(),this.checkWin())}moveRight(){let t=JSON.stringify(this.initialState);for(let t=0;t<this.state.length;t+=1){let e=this.state[t].filter(t=>0!==t),s=[],i=!1;for(let t=e.length-1;t>=0;t-=1){if(i){i=!1;continue}e[t]===e[t-1]?(this.score+=2*e[t],s.unshift(2*e[t]),i=!0):s.unshift(e[t])}for(;s.length<4;)s.unshift(0);this.state[t]=s}JSON.stringify(this.state)!==t&&(this.addRandomToState(),this.checkWin())}moveUp(){let t=JSON.stringify(this.initialState);for(let t=0;t<this.state[0].length;t+=1){let e=[];for(let s=0;s<this.state.length;s+=1)e.push(this.state[s][t]);let s=e.filter(t=>0!==t),i=[],a=!1;for(let t=0;t<s.length;t+=1){if(a){a=!1;continue}s[t]===s[t+1]?(this.score+=2*s[t],i.push(2*s[t]),a=!0):i.push(s[t])}for(;i.length<4;)i.push(0);for(let e=0;e<this.state.length;e+=1)this.state[e][t]=i[e]}JSON.stringify(this.state)!==t&&(this.addRandomToState(),this.checkWin())}moveDown(){let t=JSON.stringify(this.initialState);for(let t=0;t<this.state[0].length;t+=1){let e=[];for(let s=0;s<this.state.length;s+=1)e.push(this.state[s][t]);let s=e.filter(t=>0!==t),i=[],a=!1;for(let t=s.length-1;t>=0;t-=1){if(a){a=!1;continue}s[t]===s[t-1]?(this.score+=2*s[t],i.unshift(2*s[t]),a=!0):i.unshift(s[t])}for(;i.length<4;)i.unshift(0);for(let e=0;e<this.state.length;e+=1)this.state[e][t]=i[e]}JSON.stringify(this.state)!==t&&(this.addRandomToState(),this.checkWin())}getScore(){return this.score}getState(){return this.state}getStatus(){return this.status}start(){this.status="playing",this.addRandomToState(),this.addRandomToState()}restart(){this.state=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="playing",this.addRandomToState(),this.addRandomToState()}getNumber(){return .1>Math.random()?4:2}addRandomToState(){let t=[];for(let e=0;e<this.state.length;e+=1)for(let s=0;s<this.state[e].length;s+=1)0===this.state[e][s]&&t.push({row:e,col:s});if(!this.makeMove()){this.status="lose";return}let e=Math.floor(Math.random()*t.length),{row:s,col:i}=t[e];this.state[s][i]=this.getNumber()}makeMove(){let t=this.state.length;for(let e=0;e<t;e+=1)for(let s=0;s<t;s+=1){let i=this.state[e][s];if(0===i||e+1<t&&i===this.state[e+1][s]||s+1<t&&i===this.state[e][s+1])return!0}return!1}checkWin(){for(let t of this.state)if(t.includes(2048))return this.status="win",!0;return!1}};function r(){let t=h.getState();for(let e=0;e<s.length;e+=1){let i=[...s[e].children];for(let s=0;s<i.length;s+=1)i[s].textContent=t[e][s]||"",i[s].className="field-cell",i[s].textContent&&i[s].classList.add(`field-cell--${i[s].textContent}`)}}function o(){let e=h.getStatus();i.classList.add("hidden"),a.classList.add("hidden"),n.classList.add("hidden"),"idle"===e&&(i.classList.remove("hidden"),t.classList.add("start"),t.classList.remove("restart"),t.textContent="Start"),"playing"===e&&(t.classList.remove("start"),t.classList.add("restart"),t.textContent="Restart"),"win"===e&&a.classList.remove("hidden"),"lose"===e&&n.classList.remove("hidden")}t&&t.addEventListener("click",()=>{"idle"===h.getStatus()?h.start():h.restart(),o(),r(),e.textContent=h.getScore()}),document.addEventListener("keydown",t=>{"playing"===h.getStatus()&&("ArrowLeft"===t.key&&h.moveLeft(),"ArrowRight"===t.key&&h.moveRight(),"ArrowDown"===t.key&&h.moveDown(),"ArrowUp"===t.key&&h.moveUp(),o(),r(),e.textContent=h.getScore())});
//# sourceMappingURL=index.1c9ca023.js.map
